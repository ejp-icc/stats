<!DOCTYPE html>
<html>
<head>
    <title>Statistiques de l'Église</title>
</head>
<body>
    <h1>Statistiques de l'Église</h1>
    <div id="stats">
        Chargement des données...
    </div>

    <script>
        // Ta clé API Google
        const apiKey = "AIzaSyCw_DkDxDzfbfuWdp4czAzp1MkNUPGbHDk";
        const spreadsheetId = "1nj_axABlemhZd_XEc4ZhNhZUhP2ZJw68ONldXXkqXwU"; // ID de ton Google Sheet
        const range = "Sheet1!A:D"; // Plage des données (Date, Âmes gagnées, Nouveaux, Remarques)

        // Construire l'URL de l'API
        const apiUrl = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${range}?key=${apiKey}`;

        // Fonction pour récupérer les données du Google Sheet
        fetch(apiUrl)
            .then(response => response.json())
            .then(data => {
                console.log(data); // Debug : afficher les données dans la console

                // Vérifier si les données existent
                if (data.values) {
                    const rows = data.values; // Récupérer les lignes
                    let htmlContent = "<table border='1'><tr><th>Date</th><th>Âmes gagnées</th><th>Nouveaux</th></tr>";

                    // Parcourir les lignes et ajouter les données dans le tableau
                    rows.forEach((row, index) => {
                        if (index > 0) { // Ignorer la première ligne (en-têtes)
                            htmlContent += `
                                <tr>
                                    <td>${row[0] || ""}</td>
                                    <td>${row[1] || 0}</td>
                                    <td>${row[2] || 0}</td>
                                </tr>`;
                        }
                    });

                    htmlContent += "</table>";
                    document.getElementById("stats").innerHTML = htmlContent;
                } else {
                    document.getElementById("stats").innerText = "Aucune donnée trouvée dans le Google Sheet.";
                }
            })
            .catch(error => {
                console.error("Erreur lors de la récupération des données :", error);
                document.getElementById("stats").innerText = "Impossible de charger les données.";
            });
    </script>
</body>
</html>
